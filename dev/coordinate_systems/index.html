<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coordinate Systems · DeviceLayout.jl</title><meta name="title" content="Coordinate Systems · DeviceLayout.jl"/><meta property="og:title" content="Coordinate Systems · DeviceLayout.jl"/><meta property="twitter:title" content="Coordinate Systems · DeviceLayout.jl"/><meta name="description" content="Documentation for DeviceLayout.jl."/><meta property="og:description" content="Documentation for DeviceLayout.jl."/><meta property="twitter:description" content="Documentation for DeviceLayout.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DeviceLayout.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Geometry-Level Layout</span><ul><li><a class="tocitem" href="../geometrylevel/">Overview</a></li><li><a class="tocitem" href="../units/">Units</a></li><li><a class="tocitem" href="../points/">Points</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../transformations/">Transformations</a></li><li><a class="tocitem" href="../entitystyles/">Entity Styles</a></li><li><a class="tocitem" href="../polygons/">Polygons</a></li><li class="is-active"><a class="tocitem" href>Coordinate Systems</a><ul class="internal"><li><a class="tocitem" href="#AbstractCoordinateSystems"><span>AbstractCoordinateSystems</span></a></li><li><a class="tocitem" href="#Cells"><span>Cells</span></a></li><li><a class="tocitem" href="#CoordinateSystems"><span>CoordinateSystems</span></a></li></ul></li><li><a class="tocitem" href="../texts/">Texts</a></li><li><a class="tocitem" href="../paths/">Paths</a></li><li><a class="tocitem" href="../routes/">Routes</a></li><li><a class="tocitem" href="../shapes/">Shape library</a></li><li><a class="tocitem" href="../autofill/">Autofill</a></li><li><a class="tocitem" href="../render/">Rendering</a></li><li><a class="tocitem" href="../solidmodels/">Solid Models (3D Geometry)</a></li><li><a class="tocitem" href="../fileio/">File Formats</a></li><li><a class="tocitem" href="../faq/">Troubleshooting/FAQ</a></li></ul></li><li><span class="tocitem">Schematic-Driven Layout</span><ul><li><a class="tocitem" href="../schematicdriven/">Overview</a></li><li><a class="tocitem" href="../schematicdriven/components/">Components</a></li><li><a class="tocitem" href="../schematicdriven/hooks/">Hooks</a></li><li><a class="tocitem" href="../schematicdriven/schematics/">Schematics</a></li><li><a class="tocitem" href="../schematicdriven/technologies/">Technologies</a></li><li><a class="tocitem" href="../schematicdriven/targets/">Targets</a></li><li><a class="tocitem" href="../schematicdriven/solidmodels/">Solid Models</a></li><li><a class="tocitem" href="../schematicdriven/pdks/">PDKs</a></li><li><a class="tocitem" href="../schematicdriven/faq/">Troubleshooting/FAQ</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/examplepdk/">ExamplePDK</a></li><li><a class="tocitem" href="../examples/qpu17/">Quantum Processor</a></li><li><a class="tocitem" href="../examples/singletransmon/">Single-Transmon Simulation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Geometry-Level Layout</a></li><li class="is-active"><a href>Coordinate Systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Coordinate Systems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aws-cqc/DeviceLayout.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/main/docs/src/coordinate_systems.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Coordinate-Systems"><a class="docs-heading-anchor" href="#Coordinate-Systems">Coordinate Systems</a><a id="Coordinate-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Coordinate-Systems" title="Permalink"></a></h1><p>Coordinate systems (subtypes of <code>AbstractCoordinateSystem</code>) group geometric objects into a single structure with a common origin and coordinate axes. They can contain references to other <a href="../geometry/#DeviceLayout.GeometryStructure"><code>DeviceLayout.GeometryStructure</code></a>s, a <a href="../geometry/#DeviceLayout.GeometryEntity"><code>GeometryEntity</code></a> list, and metadata for each entity.</p><h2 id="AbstractCoordinateSystems"><a class="docs-heading-anchor" href="#AbstractCoordinateSystems">AbstractCoordinateSystems</a><a id="AbstractCoordinateSystems-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractCoordinateSystems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.AbstractCoordinateSystem" href="#DeviceLayout.AbstractCoordinateSystem"><code>DeviceLayout.AbstractCoordinateSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCoordinateSystem{S&lt;:Coordinate} &lt;: GeometryStructure{S}</code></pre><p>Abstract supertype for coordinate systems, including <code>CoordinateSystem</code> and <code>Cell</code>.</p><p>Also exists to avoid circular definitions involving the concrete <code>AbstractCoordinateSystem</code> types and subtypes of <code>GeometryReference</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/DeviceLayout.jl#L304-L311">source</a></section></article><p>Because these are subtypes of <code>GeometryStructure</code>, they can be used with the <a href="../transformations/">transformation interface</a> as well as the <a href="../geometry/#Structures">structure interface</a> including <a href="../geometry/#DeviceLayout.bounds-Tuple{DeviceLayout.AbstractGeometry}"><code>bounds</code></a> and other operations.</p><p>DeviceLayout.jl defines the concrete <a href="#DeviceLayout.CoordinateSystems.CoordinateSystem"><code>CoordinateSystem</code></a> as a backend-agnostic (or &quot;native&quot;) representation that can be converted to other representations as necessary, and <a href="#DeviceLayout.Cells.Cell"><code>Cell</code></a> as the concrete representation corresponding to the GDSII format. There is also the subtype <a href="../schematicdriven/schematics/#DeviceLayout.SchematicDrivenLayout.Schematic"><code>SchematicDrivenLayout.Schematic</code></a>, which composes a <code>CoordinateSystem</code> with schematic-level information about component connectivity.</p><h3 id="Referenced-coordinate-systems"><a class="docs-heading-anchor" href="#Referenced-coordinate-systems">Referenced coordinate systems</a><a id="Referenced-coordinate-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Referenced-coordinate-systems" title="Permalink"></a></h3><p>Coordinate systems can be <a href="../geometry/#References">arrayed or referenced</a> within other coordinate systems. These can be accessed in the array returned by <code>refs(cs)</code> or by indexing the parent coordinate system or reference with the referenced structure&#39;s name, as in <code>cs[&quot;referenced_cs&quot;][&quot;deeper_cs&quot;]</code>.</p><p>The methods <code>addref!</code> and <code>addarr!</code> are provided for adding structure references and array references.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.addref!" href="#DeviceLayout.CoordinateSystems.addref!"><code>DeviceLayout.CoordinateSystems.addref!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">addref!(c1::AbstractCoordinateSystem, cr::GeometryReference)</code></pre><p>Add the reference <code>cr</code> to the list of references in <code>c1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L8-L12">source</a></section><section><div><pre><code class="language-julia hljs">addref!(c1::AbstractCoordinateSystem{T},
    c2::GeometryStructure,
    origin=zero(Point{T});
    kwargs...)</code></pre><p>Add a reference to <code>c2</code> to the list of references in <code>c1</code>.</p><p>The reference to <code>c2</code> has origin <code>origin</code>; x-reflection, magnification factor, and rotation are set by keywords arguments.</p><p>Synonyms are accepted for these keywords:</p><ul><li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li><li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li><li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L17-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.addarr!" href="#DeviceLayout.CoordinateSystems.addarr!"><code>DeviceLayout.CoordinateSystems.addarr!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">addarr!(
    c1::AbstractCoordinateSystem{T},
    c2::GeometryStructure,
    origin::Point=zero(Point{T});
    kwargs...
)</code></pre><p>Add an <code>ArrayReference</code> to <code>c2</code> to the list of references in <code>c1</code>.</p><p>The reference to <code>c2</code> has origin <code>origin</code>. Keyword arguments specify the column vector, row vector, number of columns, number of rows, x-reflection, magnification factor, and rotation.</p><p>Synonyms are accepted for these keywords:</p><ul><li>Column vector <code>dc::Point{T}</code>: <code>:deltacol</code>, <code>:dcol</code>, <code>:dc</code>, <code>:vcol</code>, <code>:colv</code>, <code>:colvec</code>, <code>:colvector</code>, <code>:columnv</code>, <code>:columnvec</code>, <code>:columnvector</code></li><li>Row vector: <code>:deltarow</code>, <code>:drow</code>, <code>:dr</code>, <code>:vrow</code>, <code>:rv</code>, <code>:rowvec</code>, <code>:rowvector</code></li><li>Number of columns: <code>:nc</code>, <code>:numcols</code>, <code>:numcol</code>, <code>:ncols</code>, <code>:ncol</code></li><li>Number of rows: <code>:nr</code>, <code>:numrows</code>, <code>:numrow</code>, <code>:nrows</code>, <code>:nrow</code></li><li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li><li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li><li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L44-L69">source</a></section><section><div><pre><code class="language-julia hljs">addarr!(
    c1::AbstractCoordinateSystem,
    c2::GeometryStructure,
    c::AbstractRange,
    r::AbstractRange;
    kwargs...
)</code></pre><p>Add an <code>ArrayReference</code> to <code>c2</code> to the list of references in <code>c1</code>, based on ranges.</p><p><code>c</code> specifies column coordinates and <code>r</code> for the rows. Pairs from <code>c</code> and <code>r</code> specify the origins of the repeated cells. The extrema of the ranges therefore do not specify the extrema of the resulting <code>ArrayReference</code>&#39;s bounding box; some care is required.</p><p>Keyword arguments specify x-reflection, magnification factor, and rotation, with synonyms allowed:</p><ul><li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li><li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li><li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L79-L102">source</a></section></article><h3 id="Flattening"><a class="docs-heading-anchor" href="#Flattening">Flattening</a><a id="Flattening-1"></a><a class="docs-heading-anchor-permalink" href="#Flattening" title="Permalink"></a></h3><p>Sometimes it&#39;s also helpful use the <a href="../geometry/#DeviceLayout.flatten-Tuple{DeviceLayout.GeometryStructure}"><code>flatten</code></a> operation to produce an equivalent coordinate system with no references—that is, with all its elements at the top level. <code>CoordinateSystem</code>s and <code>Cell</code>s can also be flattened in place with <code>flatten!</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.flatten!-Tuple{DeviceLayout.AbstractCoordinateSystem}" href="#DeviceLayout.CoordinateSystems.flatten!-Tuple{DeviceLayout.AbstractCoordinateSystem}"><code>DeviceLayout.CoordinateSystems.flatten!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flatten!(c::AbstractCoordinateSystem, depth::Integer=-1, metadata_filter=nothing, max_copy=Inf)</code></pre><p>Recursively flatten references and arrays up to a hierarchical <code>depth</code>, adding their elements to <code>c</code> with appropriate transformations.</p><p>The references and arrays that were flattened are then discarded. Deeper references and arrays are brought upwards and are not discarded.</p><p>This function has no effect for <code>depth == 0</code>, and unlimited depth by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L159-L167">source</a></section></article><h2 id="Cells"><a class="docs-heading-anchor" href="#Cells">Cells</a><a id="Cells-1"></a><a class="docs-heading-anchor-permalink" href="#Cells" title="Permalink"></a></h2><p><code>Cell</code>s are the concrete <code>AbstractCoordinateSystem</code> representation corresponding to the GDSII format. Accordingly, they hold <code>Polygon</code>s with metadata of type <code>GDSMeta</code> (added using <code>render!</code>). They can also hold <a href="../texts/#texts"><code>Text</code> objects</a>, and they can be saved directly to a <code>.gds</code> file.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.Cell" href="#DeviceLayout.Cells.Cell"><code>DeviceLayout.Cells.Cell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct Cell{S&lt;:Coordinate}</code></pre><p>A cell has a name and contains polygons and references to <code>CellArray</code> or <code>CellReference</code> objects. It also records the time of its own creation. As currently implemented it mirrors the notion of cells in GDSII files.</p><p>To add elements, use <code>render!</code>. To add references, use <code>addref!</code> or <code>addarr!</code>. To add text, use <code>text!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L54-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.Cell-Tuple{AbstractString}" href="#DeviceLayout.Cells.Cell-Tuple{AbstractString}"><code>DeviceLayout.Cells.Cell</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cell(name::AbstractString)</code></pre><p>Convenience constructor for <code>Cell{typeof(1.0UPREFERRED)}</code>.</p><p><a href="../units/#DeviceLayout.PreferNanometers.UPREFERRED"><code>DeviceLayout.UPREFERRED</code></a> is a constant set according to the <code>unit</code> preference in <code>Project.toml</code> or <code>LocalPreferences.toml</code>. The default (<code>&quot;PreferNanometers&quot;</code>) gives <code>const UPREFERRED = DeviceLayout.nm</code>, with mixed-unit operations preferring conversion to <code>nm</code>.</p><p>Unit preference does not affect the database scale for GDS export.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L141-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.dbscale-Tuple{Cell}" href="#DeviceLayout.Cells.dbscale-Tuple{Cell}"><code>DeviceLayout.Cells.dbscale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dbscale(c::Cell)</code></pre><p>Give the database scale for a cell. The database scale is the smallest increment of length that will be represented in the output CAD file. This is different from the working coordinate type <code>T</code> of the <code>Cell</code>.</p><p>The database scale defaults to <code>1nm</code> (<code>1.0nm</code> if <code>T &lt;: FloatCoordinate</code>), but can be changed by updating <code>c.dbscale</code> to a new <code>Unitful.Length</code> quantity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L117-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.dbscale-Tuple{Cell, Cell, Vararg{Cell}}" href="#DeviceLayout.Cells.dbscale-Tuple{Cell, Cell, Vararg{Cell}}"><code>DeviceLayout.Cells.dbscale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dbscale(cell::Cell...)</code></pre><p>Choose an appropriate database scale for a GDSII file given <a href="#DeviceLayout.Cells.Cell"><code>Cell</code></a>s of different types. The smallest database scale of all cells considered is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L132-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.CellArray" href="#DeviceLayout.Cells.CellArray"><code>DeviceLayout.Cells.CellArray</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const CellArray</code></pre><p>Alias for <a href="../geometry/#DeviceLayout.ArrayReference"><code>ArrayReference</code></a>s to <code>Cell</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.CellReference" href="#DeviceLayout.Cells.CellReference"><code>DeviceLayout.Cells.CellReference</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const CellReference</code></pre><p>Alias for <a href="../geometry/#DeviceLayout.StructureReference"><code>StructureReference</code></a>s to <code>Cell</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/cells.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.GDSMeta" href="#DeviceLayout.GDSMeta"><code>DeviceLayout.GDSMeta</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GDSMeta &lt;: DeviceLayout.Meta
    layer::Int
    datatype::Int
    GDSMeta() = new(DEFAULT_LAYER, DEFAULT_DATATYPE)
    GDSMeta(l) = new(l, DEFAULT_DATATYPE)
    GDSMeta(l, d) = new(l, d)
end</code></pre><p>Metadata associated with GDSII format. Default layer and datatype are 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L79-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.render!-Tuple{Cell, Polygon, GDSMeta}" href="#DeviceLayout.render!-Tuple{Cell, Polygon, GDSMeta}"><code>DeviceLayout.render!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">render!(c::Cell, p::Polygon, meta::GDSMeta=GDSMeta())</code></pre><p>Render a polygon <code>p</code> to cell <code>c</code>, defaulting to plain styling. If <code>p</code> has more than 8190 (set by DeviceLayout&#39;s <code>GDS_POLYGON_MAX</code> constant), then it is partitioned into smaller polygons which are then rendered. Environment variable <code>ENV[&quot;GDS_POLYGON_MAX&quot;]</code> will override this constant. The partitioning algorithm implements guillotine cutting, that goes through at least one existing vertex and in manhattan directions. Cuts are selected by ad hoc optimzation for &quot;nice&quot; partitions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/render/polygons.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.save-Tuple{File{DataFormat{:GDS}}, Cell, Vararg{Cell}}" href="#DeviceLayout.save-Tuple{File{DataFormat{:GDS}}, Cell, Vararg{Cell}}"><code>DeviceLayout.save</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save(::Union{AbstractString,IO}, cell0::Cell{T}, cell::Cell...)
save(f::File{format&quot;GDS&quot;}, cell0::Cell, cell::Cell...;
    name=&quot;GDSIILIB&quot;, userunit=1μm, modify=now(), acc=now(),
    verbose=false)</code></pre><p>This bottom method is implicitly called when you use the convenient syntax of the top method: <code>save(&quot;/path/to/my.gds&quot;, cells_i_want_to_save...)</code></p><p>Keyword arguments include:</p><ul><li><code>name</code>: used for the internal library name of the GDSII file and probably inconsequential for modern workflows.</li><li><code>userunit</code>: sets what 1.0 corresponds to when viewing this file in graphical GDS editors with inferior unit support.</li><li><code>modify</code>: date of last modification.</li><li><code>acc</code>: date of last accession. It would be unusual to have this differ from <code>now()</code>.</li><li><code>verbose</code>: monitor the output of <a href="#DeviceLayout.CoordinateSystems.traverse!"><code>traverse!</code></a> and <a href="#DeviceLayout.CoordinateSystems.order!"><code>order!</code></a> to see if something funny is happening while saving.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/backends/gds.jl#L509-L528">source</a></section></article><p>The type parameter <code>S</code> of a <code>Cell{S}</code> object determine the type of the coordinates of all polygons in a cell, including the units and whether integer or floating-point values are used. Currently, you cannot do a whole lot (particularly with regard to paths) if the cell has integer coordinates. However, they do have an inherent advantage because the coordinates are exact, and ultimately the GDSII file represents shapes with integer coordinates.</p><p>Separately, the <code>Cell</code> has a &quot;database scale&quot; (the <code>dbscale</code> field) applied when saving that defaults to <code>1nm</code> but can be changed.</p><p>For most cases, if you want to use units, <code>Cell(&quot;my_cell_name&quot;, nm)</code> is a good way to construct a cell which will ultimately have all coordinates rounded to the nearest <code>nm</code> when exported into GDSII. You can add polygons with whatever length units you want to such a cell, and the coordinates will be converted automatically to <code>nm</code>.</p><p>If you don&#39;t want units, just construct the cell with a name only: <code>Cell(&quot;my_cell_name&quot;)</code> will return a <code>Cell{Float64}</code> object unless you have set a <a href="../units/#Unit-preferences">unit preference</a>. In this case too, the ultimate database resolution is <code>1nm</code>; until exporting the cell into a GDSII file, the coordinates are interpreted to be in units of <code>1μm</code>.</p><p>When saving cells to disk, keep in mind that cells should have unique names. We don&#39;t have an automatic renaming scheme implemented to avoid clashes. To help with this, we provide a function <a href="../geometry/#DeviceLayout.uniquename"><code>uniquename</code></a> to generate unique names based on human-readable prefixes.</p><p>When saving cells to disk, there will be a tree of interdependencies and logically one would prefer to write the leaf nodes of the tree before any dependent cells. These functions are used to traverse the tree and then find the optimal ordering.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.traverse!" href="#DeviceLayout.CoordinateSystems.traverse!"><code>DeviceLayout.CoordinateSystems.traverse!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">traverse!(a::AbstractArray, c::GeometryStructure, level=1)</code></pre><p>Given a coordinate system, recursively traverse its references for other coordinate systems and add to array <code>a</code> some tuples: <code>(level, c)</code>. <code>level</code> corresponds to how deep the coordinate system was found, and <code>c</code> is the found coordinate system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L128-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.order!" href="#DeviceLayout.CoordinateSystems.order!"><code>DeviceLayout.CoordinateSystems.order!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">order!(a::AbstractArray)</code></pre><p>Given an array of tuples like that coming out of <a href="#DeviceLayout.CoordinateSystems.traverse!"><code>traverse!</code></a>, we sort by the <code>level</code>, strip the level out, and then retain unique entries. The aim of this function is to determine an optimal writing order when saving pattern data (although the GDSII spec does not require cells to be in a particular order, there may be performance ramifications).</p><p>For performance reasons, this function modifies <code>a</code> but what you want is the returned result array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordsys_interface.jl#L142-L153">source</a></section></article><h2 id="CoordinateSystems"><a class="docs-heading-anchor" href="#CoordinateSystems">CoordinateSystems</a><a id="CoordinateSystems-1"></a><a class="docs-heading-anchor-permalink" href="#CoordinateSystems" title="Permalink"></a></h2><p><code>CoordinateSystem</code>s are &quot;DeviceLayout-native&quot; <code>AbstractCoordinateSystem</code>s. Unlike <code>Cell</code>s, they can hold any <code>GeometryEntity</code>, not just <code>Polygon</code>s, as well as references to any <code>GeometryStructure</code>, not just <code>Cell</code>s. The idea is to work with an exact or logical representation of geometric elements as long as possible, deferring decisions about output representations until rendering time. This allows things like calculating intersection points between <code>Path</code>s in a hierarchy of <code>CoordinateSystem</code>s and references, or rendering exact curves to a <code>SolidModel</code>.</p><p>Because of this, we add entities to a <code>CoordinateSystem</code> with <code>place!</code> rather than <code>render!</code>. The different verb is meant to convey that the entity is added as-is rather than potentially converted to some other representation. (For convenience, <code>render!</code> still works with <code>CoordinateSystem</code>s, but it&#39;s just an alias for <code>place!</code>.)</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.CoordinateSystem" href="#DeviceLayout.CoordinateSystems.CoordinateSystem"><code>DeviceLayout.CoordinateSystems.CoordinateSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct CoordinateSystem{S&lt;:Coordinate} &lt;: AbstractCoordinateSystem{S}
    name::String
    elements::Vector{GeometryEntity{S}}
    meta::Vector{Meta}
    refs::Vector{GeometryReference}
    create::DateTime

    CoordinateSystem{S}(x, y, ym, z, t) where {S} = new{S}(x, y, ym, z, t)
    CoordinateSystem{S}(x, y, ym, z) where {S} = new{S}(x, y, ym, z, now())
    CoordinateSystem{S}(x, y, ym) where {S} = new{S}(x, y, ym, GeometryReference[], now())
    CoordinateSystem{S}(x) where {S} =
        new{S}(x, GeometryEntity{S}[], Meta[], GeometryReference[], now())
    CoordinateSystem{S}() where {S} = begin
        c = new{S}()
        c.elements = GeometryEntity{S}[]
        c.meta = Meta[]
        c.refs = GeometryReference[]
        c.create = now()
        c
    end
end</code></pre><p>A <code>CoordinateSystem</code> has a name and contains geometry entities (Polygons, Rectangles) and references to <code>GeometryStructure</code> objects. It also records the time of its own creation.</p><p>To add elements, use <code>place!</code>, or use <code>render!</code> to be agnostic between <code>CoordinateSystem</code> and <code>Cell</code>. To add references, use <code>addref!</code> or <code>addarr!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordinate_systems.jl#L50-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.CoordinateSystemReference" href="#DeviceLayout.CoordinateSystems.CoordinateSystemReference"><code>DeviceLayout.CoordinateSystems.CoordinateSystemReference</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const CoordinateSystemReference</code></pre><p>Alias for <a href="../geometry/#DeviceLayout.StructureReference"><code>StructureReference</code></a>s to <code>CoordinateSystem</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordinate_systems.jl#L157-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.CoordinateSystemArray" href="#DeviceLayout.CoordinateSystems.CoordinateSystemArray"><code>DeviceLayout.CoordinateSystems.CoordinateSystemArray</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const CoordinateSystemArray</code></pre><p>Alias for <a href="../geometry/#DeviceLayout.ArrayReference"><code>ArrayReference</code></a>s to <code>CoordinateSystem</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordinate_systems.jl#L164-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.CoordinateSystems.place!" href="#DeviceLayout.CoordinateSystems.place!"><code>DeviceLayout.CoordinateSystems.place!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">place!(cs::CoordinateSystem, ent::GeometryEntity, metadata)</code></pre><p>Place <code>ent</code> in <code>cs</code> with metadata <code>metadata</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordinate_systems.jl#L131-L135">source</a></section><section><div><pre><code class="language-julia hljs">place!(cs::CoordinateSystem, s::GeometryStructure)</code></pre><p>Place a reference to <code>s</code> in <code>cs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/coordinate_systems.jl#L148-L152">source</a></section><section><div><pre><code class="language-julia hljs">place!(cs::CoordinateSystem, p::Path, metadata=p.metadata)</code></pre><p>Place a reference to <code>p</code> in <code>cs</code> and set metadata to <code>metadata</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/paths/paths.jl#L1311-L1315">source</a></section></article><p>As with a <code>Cell{S}</code>, a <code>CoordinateSystem{S}</code> has a coordinate type parameter <code>S</code>. Unlike <code>Cell</code>s, a <code>CoordinateSystem</code> is not tied to a database unit (a GDSII concept).</p><h3 id="Semantic-metadata-and-rendering-to-cells"><a class="docs-heading-anchor" href="#Semantic-metadata-and-rendering-to-cells">Semantic metadata and rendering to cells</a><a id="Semantic-metadata-and-rendering-to-cells-1"></a><a class="docs-heading-anchor-permalink" href="#Semantic-metadata-and-rendering-to-cells" title="Permalink"></a></h3><p>Since <code>CoordinateSystem</code>s are intended to be backend-agnostic, a useful pattern is to give coordinate objects &quot;semantic&quot; metadata, consisting of a layer name <code>Symbol</code> as well as <code>level</code> and <code>index</code> attributes. This metadata can then be processed with designer-provided methods when rendering to an output format.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.SemanticMeta" href="#DeviceLayout.SemanticMeta"><code>DeviceLayout.SemanticMeta</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SemanticMeta &lt;: DeviceLayout.Meta
    layer::Symbol
    index::Int = 1
    level::Int = 1
end
SemanticMeta(layer::String; kwargs...)
SemanticMeta(meta::Meta; kwargs...)</code></pre><p>DeviceLayout-native representation of an object&#39;s layer information and attributes.</p><p>Semantic metadata refers to the meaning of an element without reference to a fixed encoding. For example, “this polygon is in the negative of the ground plane” is semantic, while “this polygon is in GDS layer 1, datatype 2” is not. The semantic metadata is used in the final <code>render</code> step, where a layout is converted from a <code>CoordinateSystem</code> to a representation corresponding to a particular output format (e.g., a <code>Cell</code> for GDSII). A call to <code>render!(cell::Cell{S}, cs::CoordinateSystem; map_meta = identity, kwargs...)</code> will use the <code>map_meta</code> function to map each <code>GeometryEntity</code>&#39;s metadata to <code>GDSMeta</code>.</p><p>The <code>level</code> and <code>index</code> fields do not have a strict interpretation imposed by DeviceLayout. (In this sense they are similar to GDS <code>datatype</code>.) The suggested use is as follows:</p><ul><li><code>index</code> distinguishes numbered instances within a layer, for example in greyscale lithography or port numbering</li><li><code>level</code> distinguishes instances of a layer occurring in different contexts, such as in a 3D stack where equivalent layers may be present in multiple levels</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.layer" href="#DeviceLayout.layer"><code>DeviceLayout.layer</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">layer(m::Meta)</code></pre><p>The layer specified by <code>m</code>, as a <code>Symbol</code>.</p><p>For example, <code>layer(GDSMeta(1, 2))</code> is <code>:GDS1_2</code>, and <code>layername(SemanticMeta(:base))</code> is <code>:base</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.layerindex" href="#DeviceLayout.layerindex"><code>DeviceLayout.layerindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">layerindex(m::Meta)</code></pre><p>The <code>index</code> specified by metadata <code>m</code>. Defaults to <code>1</code> for metadata types without an <code>index</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.layername" href="#DeviceLayout.layername"><code>DeviceLayout.layername</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">layername(m::Meta)</code></pre><p>The layer specified by <code>m</code>, as a <code>String</code>.</p><p>For example, <code>layer(GDSMeta(1, 2))</code> is <code>&quot;GDS1_2&quot;</code>, and <code>layername(SemanticMeta(:base))</code> is <code>&quot;base&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L68-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.level" href="#DeviceLayout.level"><code>DeviceLayout.level</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">level(m::Meta)</code></pre><p>The <code>level</code> specified by metadata <code>s</code>. Defaults to <code>1</code> for metadata types without a <code>level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/metadata.jl#L52-L56">source</a></section></article><p>This means that a <code>CoordinateSystem</code> can be rendered to a <code>Cell</code> for output to a GDS format. During rendering, an <code>entity::GeometryEntity</code> with metadata <code>SemanticMeta(:ground_plane)</code> would be mapped to <code>to_polygons(entity)</code> with GDS layer number and datatype (for example, <code>GDSMeta(1,0)</code>) corresponding to the ground plane according to a mapping function <code>map_meta</code> provided to <code>render!</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.Cells.Cell-Union{Tuple{CoordinateSystem{S}}, Tuple{S}} where S" href="#DeviceLayout.Cells.Cell-Union{Tuple{CoordinateSystem{S}}, Tuple{S}} where S"><code>DeviceLayout.Cells.Cell</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cell(cs::CoordinateSystem{S}) = Cell{S}(cs)
Cell(cs::CoordinateSystem, unit::CoordinateUnits) = Cell{typeof(1.0unit)}(cs)
Cell{S}(cs::CoordinateSystem) where {S}</code></pre><p>Construct a <code>Cell</code> from a <code>CoordinateSystem</code> by rendering its contents, reproducing the reference hierarchy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/render/render.jl#L155-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.render!-Tuple{Cell, DeviceLayout.GeometryStructure}" href="#DeviceLayout.render!-Tuple{Cell, DeviceLayout.GeometryStructure}"><code>DeviceLayout.render!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">render!(cell::Cell{S}, cs::GeometryStructure;
    memoized_cells=Dict{CoordinateSystem, Cell}(),
    map_meta = identity,
    kwargs...) where {S}</code></pre><p>Render a geometry structure (e.g., <code>CoordinateSystem</code>) to a cell.</p><p>Passes each element and its metadata (mapped by <code>map_meta</code> if a method is supplied) to <code>render!(::Cell, element, ::Meta)</code>, traversing the references such that if a CoordinateSystem is referred to in multiple places, it will become a single cell referred to in multiple places.</p><p>Rendering a <code>GeometryEntity</code> to a <code>Cell</code> uses the optional keyword arguments</p><ul><li><code>map_meta</code>, a function that takes a <code>Meta</code> object and returns another <code>Meta</code> object (or <code>nothing</code>, in which case rendering is skipped)</li></ul><p>Usage note: calling this function with non-empty dictionary <code>memoized_cells = Dict{CoordinateSystem, Cell}(cs =&gt; cell)</code> is effectively a manual override that forces <code>cs</code> to render as <code>cell</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/render/render.jl#L175-L196">source</a></section></article><p>Note that <code>Cell</code>s inherit the names of rendered <code>CoordinateSystem</code>s, so the original coordinate systems ought to have unique names (for example using <a href="../geometry/#DeviceLayout.uniquename"><code>uniquename</code></a>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../polygons/">« Polygons</a><a class="docs-footer-nextpage" href="../texts/">Texts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 27 February 2025 13:39">Thursday 27 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
