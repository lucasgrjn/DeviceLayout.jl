<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Units · DeviceLayout.jl</title><meta name="title" content="Units · DeviceLayout.jl"/><meta property="og:title" content="Units · DeviceLayout.jl"/><meta property="twitter:title" content="Units · DeviceLayout.jl"/><meta name="description" content="Documentation for DeviceLayout.jl."/><meta property="og:description" content="Documentation for DeviceLayout.jl."/><meta property="twitter:description" content="Documentation for DeviceLayout.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DeviceLayout.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Geometry-Level Layout</span><ul><li><a class="tocitem" href="../geometrylevel/">Overview</a></li><li class="is-active"><a class="tocitem" href>Units</a></li><li><a class="tocitem" href="../points/">Points</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../transformations/">Transformations</a></li><li><a class="tocitem" href="../entitystyles/">Entity Styles</a></li><li><a class="tocitem" href="../polygons/">Polygons</a></li><li><a class="tocitem" href="../coordinate_systems/">Coordinate Systems</a></li><li><a class="tocitem" href="../texts/">Texts</a></li><li><a class="tocitem" href="../paths/">Paths</a></li><li><a class="tocitem" href="../routes/">Routes</a></li><li><a class="tocitem" href="../shapes/">Shape library</a></li><li><a class="tocitem" href="../autofill/">Autofill</a></li><li><a class="tocitem" href="../render/">Rendering</a></li><li><a class="tocitem" href="../solidmodels/">Solid Models (3D Geometry)</a></li><li><a class="tocitem" href="../fileio/">File Formats</a></li><li><a class="tocitem" href="../faq/">Troubleshooting/FAQ</a></li></ul></li><li><span class="tocitem">Schematic-Driven Layout</span><ul><li><a class="tocitem" href="../schematicdriven/">Overview</a></li><li><a class="tocitem" href="../schematicdriven/components/">Components</a></li><li><a class="tocitem" href="../schematicdriven/hooks/">Hooks</a></li><li><a class="tocitem" href="../schematicdriven/schematics/">Schematics</a></li><li><a class="tocitem" href="../schematicdriven/technologies/">Technologies</a></li><li><a class="tocitem" href="../schematicdriven/targets/">Targets</a></li><li><a class="tocitem" href="../schematicdriven/solidmodels/">Solid Models</a></li><li><a class="tocitem" href="../schematicdriven/pdks/">PDKs</a></li><li><a class="tocitem" href="../schematicdriven/faq/">Troubleshooting/FAQ</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/examplepdk/">ExamplePDK</a></li><li><a class="tocitem" href="../examples/qpu17/">Quantum Processor</a></li><li><a class="tocitem" href="../examples/singletransmon/">Single-Transmon Simulation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Geometry-Level Layout</a></li><li class="is-active"><a href>Units</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Units</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aws-cqc/DeviceLayout.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/main/docs/src/units.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Units"><a class="docs-heading-anchor" href="#Units">Units</a><a id="Units-1"></a><a class="docs-heading-anchor-permalink" href="#Units" title="Permalink"></a></h1><p>DeviceLayout.jl uses <a href="http://painterqubits.github.io/Unitful.jl/stable/">Unitful.jl</a> to support writing code with explicit units.</p><p>In general, geometric types are parameterized by a <a href="../geometry/#DeviceLayout.coordinatetype"><code>coordinatetype</code></a>, which is either a <code>Real</code> or a <code>Unitful.Length</code> (for example, <code>typeof(1.0nm)</code>). We want to ensure that unitful numbers in a geometry have a common representation, allowing more efficient manipulation and avoiding unnecessary conversions and compilations.</p><p>Recall the quick-start example from the home page:</p><pre><code class="language-julia hljs">using DeviceLayout, DeviceLayout.PreferredUnits, FileIO

cr = Cell(&quot;rect&quot;, nm)
r = centered(Rectangle(20μm, 40μm))
render!(cr, r, GDSMeta(1, 0))
p = Path(μm)
sty = launch!(p)
straight!(p, 500μm, sty)
turn!(p, π / 2, 150μm)
straight!(p, 500μm)
launch!(p)
cp = Cell(&quot;pathonly&quot;, nm)
render!(cp, p, GDSMeta(0))
turnidx = Int((length(p) + 1) / 2) - 1 # the first straight segment of the path
simplify!(p, turnidx .+ (0:2))
attach!(
    p,
    CellReference(cr, Point(0.0μm, 0.0μm)),
    (40μm):(40μm):((pathlength(p[turnidx])) - 40μm),
    i=turnidx
)
c = Cell(&quot;decoratedpath&quot;, nm)
render!(c, p, GDSMeta(0))</code></pre><img src="../units.svg" style="width: 3in;"/><p>The example begins with <code>using DeviceLayout.PreferredUnits</code>, which enables the unqualified use of the following units: <code>pm</code>, <code>nm</code>, <code>μm</code>, <code>mm</code>, <code>cm</code>, <code>dm</code>, <code>m</code>. (By unqualified we mean that the symbols are imported into the calling namespace and do not need to be prefixed with a module name. <code>using DeviceLayout</code> also gives you <code>°</code> and <code>rad</code> for angles.) <code>DeviceLayout.PreferredUnits</code> is, by default, an alias for <code>DeviceLayout.PreferNanometers</code>. This means that when adding length units together, if the units don&#39;t agree, the result will be in nanometers.</p><p>You can instead do <code>using DeviceLayout.PreferMicrons</code> if you want the result to default to microns. This is simple and effective, but does not enforce consistency across large projects like process design kits (PDKs) or layout scripts with multiple modules that might accidentally import units in different ways. Accordingly, DeviceLayout.jl provides a slightly more sophisticated method to specify alternative preferences using a configuration setting applied at compilation time, which is described below.</p><h3 id="Unit-preferences"><a class="docs-heading-anchor" href="#Unit-preferences">Unit preferences</a><a id="Unit-preferences-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-preferences" title="Permalink"></a></h3><p>By default, DeviceLayout will be compiled with <code>using .PreferNanometers</code> internally. If you then import units from DeviceLayout</p><pre><code class="language-julia hljs">using DeviceLayout.PreferredUnits</code></pre><p>or, more explicitly,</p><pre><code class="language-julia hljs">import DeviceLayout: nm, μm, mm #, ...</code></pre><p>you get the unqualified units as described above. This also defines <code>const UPREFERRED = DeviceLayout.PreferNanometers.nm</code>. In the handful of places that <code>UPREFERRED</code> appears in DeviceLayout.jl (convenience constructors and type aliases allowing users to omit explicit unit specification), it&#39;ll then be <code>ContextUnits</code> that prefers to be converted to nanometers.</p><p>If you want different behavior, then the recommended practice is to specify a unit preference as a package preference and then import unit symbols from DeviceLayout. That is, if you put a file called <code>LocalPreferences.toml</code> in the root of a project directory with</p><pre><code class="nohighlight hljs">[DeviceLayout]
units = &quot;PreferMicrons&quot;</code></pre><p>then DeviceLayout will be compiled with <code>using .PreferMicrons</code> internally. (This is accomplished using <a href="https://juliapackaging.github.io/Preferences.jl/stable/">Preferences.jl</a>.) That means that <code>DeviceLayout.nm</code> and so on will prefer to be converted to microns, and <code>const UPREFERRED = DeviceLayout.μm</code>.</p><p>Similarly, if we have the preference <code>units = &quot;NoUnits&quot;</code>, then DeviceLayout uses <code>import Unitful: nm, ...</code> and <code>const UPREFERRED = Unitful.NoUnits; const PreferredUnits = PreferMicrons</code> internally.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.PreferNanometers.UPREFERRED" href="#DeviceLayout.PreferNanometers.UPREFERRED"><code>DeviceLayout.PreferNanometers.UPREFERRED</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const PreferNanometers.UPREFERRED = nm</code></pre><p>Constant for DeviceLayout.jl compiled with <code>units = &quot;PreferNanometers&quot;</code> in <code>LocalPreferences.toml</code>.</p><p>Default value if no preference specified. Other options are <code>PreferMicrons</code> and <code>NoUnits</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/units.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.PreferMicrons.UPREFERRED" href="#DeviceLayout.PreferMicrons.UPREFERRED"><code>DeviceLayout.PreferMicrons.UPREFERRED</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const PreferMicrons.UPREFERRED = μm</code></pre><p>Constant for DeviceLayout.jl compiled with <code>units = &quot;PreferMicrons&quot;</code> in <code>LocalPreferences.toml</code>.</p><p>Other options are <code>PreferNanometers</code> (the default) and <code>NoUnits</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/units.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.PreferNoUnits.UPREFERRED" href="#DeviceLayout.PreferNoUnits.UPREFERRED"><code>DeviceLayout.PreferNoUnits.UPREFERRED</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const UPREFERRED = Unitful.NoUnits</code></pre><p>Constant for DeviceLayout.jl compiled with <code>units = &quot;NoUnits&quot;</code> in LocalPreferences.toml.</p><p>Other options are <code>PreferNanometers</code> (the default) and <code>PreferMicrons</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/units.jl#L51-L57">source</a></section></article><p>You can also set the preference in <code>Project.toml</code> with the following lines:</p><pre><code class="nohighlight hljs">[preferences.DeviceLayout]
units = &quot;PreferMicrons&quot;</code></pre><p>Typically, <code>LocalPreferences.toml</code> will be ignored by version control (that is, listed in <code>.gitignore</code>), so you&#39;ll use it to set preferences that are only meant to be used locally. If you want preferences to be used by anyone cloning and instantiating your project, then you&#39;ll put them in <code>Project.toml</code>.</p><p>For convenience, you can use <code>DeviceLayout.set_unit_preference!</code> to add the preference to either <code>LocalPreferences.toml</code> or <code>Project.toml</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeviceLayout.set_unit_preference!" href="#DeviceLayout.set_unit_preference!"><code>DeviceLayout.set_unit_preference!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_unit_preference!(pref::String; local_only=true)</code></pre><p>Set the unit preference. <code>pref</code> must be one of &quot;NoUnits&quot;, &quot;PreferMicrons&quot;, or &quot;PreferNanometers&quot;.</p><p>If <code>local_only</code> is <code>true</code>, add the preference to <code>LocalPreferences.toml</code>. Otherwise, add it to <code>Project.toml</code>.</p><p>Because this preference is used at compile time, Julia must be restarted for a change to take effect.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aws-cqc/DeviceLayout.jl/blob/89c9228ef5c3593070ef47c44c8141f19efd9067/src/units.jl#L99-L107">source</a></section></article><p>Note that only preferences of the active project are applied. For example, if you have a separate package defining your process design kit (PDK), adding the preference to <code>Project.toml</code> does not mean that any project that uses the PDK will inherit that preference. If a PDK is meant to be used with units, you can have it set the preference during package setup:</p><pre><code class="language-julia hljs">module MyPDK
using DeviceLayout

function __init__()
    return DeviceLayout.set_unit_preference!(&quot;PreferNanometers&quot;; local_only=false)
end
# ...
end</code></pre><p>Because the preference is used at compile time, Julia will have to be restarted if the preference was not already set.</p><h3 id="Example-without-using-units"><a class="docs-heading-anchor" href="#Example-without-using-units">Example without using units</a><a id="Example-without-using-units-1"></a><a class="docs-heading-anchor-permalink" href="#Example-without-using-units" title="Permalink"></a></h3><p>While units are recommended, it is possible to use DeviceLayout.jl without units at all for compatibility and laziness reasons.</p><p><strong>If you do not provide units, all values are presumed to be in microns.</strong> The syntax is otherwise the same:</p><pre><code class="language-julia hljs">using DeviceLayout, FileIO

cr = Cell{Float64}(&quot;rect&quot;) # If unit preference were `NoUnits`, we wouldn&#39;t need `{Float64}`
r = centered(Rectangle(20, 40))
render!(cr, r, GDSMeta(1))

p = Path{Float64}()
sty = launch!(p)
straight!(p, 500, sty)
turn!(p, π / 2, 150)
straight!(p, 500)
launch!(p)
cp = Cell{Float64}(&quot;pathonly&quot;)
render!(cp, p, GDSMeta(0))

turnidx = Int((length(p) + 1) / 2) - 1 # the first straight segment of the path
simplify!(p, turnidx .+ (0:2))
attach!(
    p,
    CellReference(cr, Point(0.0, 0.0)),
    40:40:((pathlength(p[turnidx])) - 40),
    i=turnidx
)
c = Cell{Float64}(&quot;decoratedpath&quot;)
render!(c, p, GDSMeta(0))
flatten(c) # just show using default colors</code></pre><img src="4b146c9c.svg" alt="Example block output"/><p>Maintaining unitless functionality alongside unitful functionality takes some care, so you may encounter errors when using unitless geometries, particularly with less mature features. Please file an issue if that happens.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>It&#39;s usually not too hard to write library code that works with or without units. Often it&#39;s as simple as making sure you&#39;re not overly strict with type annotations and not writing literal coordinate values. For example, use <a href="../points/#DeviceLayout.Coordinate"><code>DeviceLayout.Coordinate</code></a> rather than <code>Unitful.Length</code> if you also want to accept <code>Real</code> values, and use the <a href="https://docs.julialang.org/en/v1/base/numbers/#Base.zero"><code>zero</code></a> function rather than <code>0.0nm</code>.</p></div></div><h3 id="Angles"><a class="docs-heading-anchor" href="#Angles">Angles</a><a id="Angles-1"></a><a class="docs-heading-anchor-permalink" href="#Angles" title="Permalink"></a></h3><p>Throughout the interface, users can provide angles as unitless real numbers, which will be interpreted as radians, or as Unitful numbers using degrees (<code>°</code>, which can be written in the REPL or in VS Code by typing <code>\degree</code> and hitting the Tab key) or radians (<code>rad</code>), both exported by DeviceLayout.jl. Angles are generally stored internally as degrees.</p><h3 id="More-on-units"><a class="docs-heading-anchor" href="#More-on-units">More on units</a><a id="More-on-units-1"></a><a class="docs-heading-anchor-permalink" href="#More-on-units" title="Permalink"></a></h3><p>You cannot mix and match unitful and unitless numbers (the latter are not presumed to be in microns in this case).</p><p>When you specify the units for a <code>Cell</code>, you are specifying the coordinate type of its elements. Separately, the cell has a database unit stored in its <code>dbscale</code> field, which defaults to 1 nm. Anything rendered into this cell will be discretized into integer multiples of the database unit upon saving to the GDSII format. This means that if the specified unit is <code>nm</code>, nothing smaller than 1 nm can be represented accurately. Nonetheless, this is typically a satisfactory choice for superconducting devices. If you are using a unitless <code>Cell</code>, the database unit will be 0.001 (that is, 1 nm).</p><p><code>μ</code> can be input in the REPL or in VS Code by typing <code>\mu</code> and hitting the Tab key. Some people find it convenient to define <code>const um = DeviceLayout.μm</code> in their scripts.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../geometrylevel/">« Overview</a><a class="docs-footer-nextpage" href="../points/">Points »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 27 February 2025 13:39">Thursday 27 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
